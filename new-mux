#!/bin/bash

defaultsession=default
session=${1:-$defaultsession}
sessions=`tmux list-sessions`
if [ 0 -eq $? ]
then
    grep -E "^${session}" <<< $sessions
    if [ $?  -eq 0 ]
    then
        tmux attach -t "${session}"
        exit 0
    fi
fi

echo "starting new sessions named ${session}"

cd ~/src/git.rs.ring.com/
tmux -2 new-session -d -s "${session}"

tmux rename-window -t0 'hub-code'
tmux send-keys 'cd hub-core/hub-core/src' 'C-m'

tmux new-window
tmux rename-window -t1 'hub-build'
tmux send-keys 'cd ../vagrant' 'C-m'
tmux send-keys 'vagrant ssh' 'C-m'

tmux new-window
tmux rename-window -t2 'go-code'
tmux send-keys 'cd go' 'C-m'

tmux attach -t base

exit 0
