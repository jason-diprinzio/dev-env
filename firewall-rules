/ip firewall filter
add chain=input action=accept connection-state=established,related comment="allow existing"
add chain=input action=accept src-address-list=allowed_to_router
add chain=input action=accept protocol=icmp comment="allow icmp"
add chain=input action=accept src-address=192.168.1.1/24 in-interface=!ether1
add chain=input action=accept src-address=192.168.88.0/24 in-interface=!ether1
add chain=input action=drop connection-state=invalid comment="Drop Invalid connections"
add chain=input action=drop comment="Drop everything else"
add chain=forward action=fasttrack-connection connection-state=established,related comment="FastTrack existing conns"
add chain=forward action=accept connection-state=established comment="allow already established connections"
add chain=forward action=accept connection-state=related comment="allow related connections"
add chain=forward action=drop in-interface=ether1 src-address-list=not_in_internet comment="Drop incoming from internet which is not public IP"
add chain=forward action=drop connection-nat-state=!dstnat connection-state=new in-interface=ether1 log=yes log-prefix=!NAT comment="Drop incoming packets that are not NATted"
add chain=forward action=drop in-interface=bridge1 src-address=!192.168.88.0/24 comment="Drop packets from LAN that do not have LAN IP"
add chain=forward action=drop dst-address-list=not_in_internet in-interface=bridge1 log=yes log-prefix=!public_from_LAN out-interface=!bridge1 comment="Drop tries to reach non-public addresses from LAN"
add chain=forward action=drop protocol=tcp connection-state=invalid comment="drop invalid connections"
add chain=forward action=drop dst-address=0.0.0.0/8
add chain=forward action=drop dst-address=127.0.0.0/8
add chain=forward action=drop dst-address=224.0.0.0/3
add chain=forward action=drop src-address=0.0.0.0/8
add chain=forward action=drop src-address=127.0.0.0/8
add chain=forward action=drop src-address=224.0.0.0/3
add chain=forward action=jump protocol=tcp jump-target=tcp
add chain=forward action=jump protocol=udp jump-target=udp
add chain=forward action=jump protocol=icmp jump-target=icmp
add chain=tcp protocol=tcp dst-port=21-53 action=drop comment="deny Basics"
add chain=tcp protocol=tcp dst-port=67-68 action=drop comment="deny DHCP"
add chain=tcp protocol=tcp dst-port=69 action=drop comment="deny TFTP"
add chain=tcp protocol=tcp dst-port=111 action=drop comment="deny RPC portmapper"
add chain=tcp protocol=tcp dst-port=135 action=drop comment="deny RPC portmapper"
add chain=tcp protocol=tcp dst-port=137-139 action= comment="deny NBT"
add chain=tcp protocol=tcp dst-port=445 action=drop comment="deny cifs"
add chain=tcp protocol=tcp dst-port=2049 action=drop comment="deny NFS"
add chain=tcp protocol=tcp dst-port=3133 action=drop comment="deny BackOriffice"
add chain=tcp protocol=tcp dst-port=12345-12346 action=drop comment="deny NetBus"
add chain=tcp protocol=tcp dst-port=20034 action=drop comment="deny NetBus"
add chain=icmp protocol=icmp icmp-options=0:0 action=accept comment="echo reply"
add chain=icmp protocol=icmp icmp-options=3:0 action=accept comment="net unreachable"
add chain=icmp protocol=icmp icmp-options=3:1 action=accept comment="host unreachable"
add chain=icmp protocol=icmp icmp-options=3:4 action=accept comment="host unreachable fragmentation required"
add chain=icmp protocol=icmp icmp-options=4:0 action=accept comment="allow source quench"
add chain=icmp protocol=icmp icmp-options=8:0 action=accept comment="allow echo request"
add chain=icmp protocol=icmp icmp-options=11:0 action=accept comment="allow time exceed"
add chain=icmp protocol=icmp icmp-options=12:0 action=accept comment="allow parameter bad"
add chain=icmp action=drop comment="deny all other types"
/ip firewall address-list
add address=192.168.88.2-192.168.88.254 list=allowed_to_router
add address=0.0.0.0/8 comment=RFC6890 list=not_in_internet
add address=172.16.0.0/12 comment=RFC6890 list=not_in_internet
add address=192.168.0.0/16 comment=RFC6890 list=not_in_internet
add address=10.0.0.0/8 comment=RFC6890 list=not_in_internet
add address=169.254.0.0/16 comment=RFC6890 list=not_in_internet
add address=127.0.0.0/8 comment=RFC6890 list=not_in_internet
add address=224.0.0.0/4 comment=Multicast list=not_in_internet
add address=198.18.0.0/15 comment=RFC6890 list=not_in_internet
add address=192.0.0.0/24 comment=RFC6890 list=not_in_internet
add address=192.0.2.0/24 comment=RFC6890 list=not_in_internet
add address=198.51.100.0/24 comment=RFC6890 list=not_in_internet
add address=203.0.113.0/24 comment=RFC6890 list=not_in_internet
add address=100.64.0.0/10 comment=RFC6890 list=not_in_internet
add address=240.0.0.0/4 comment=RFC6890 list=not_in_internet
add address=192.88.99.0/24 comment="6to4 relay Anycast [RFC 3068]" list=not_in_internet

